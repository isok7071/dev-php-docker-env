version: '3'

services:
  nginx:
    build:
      dockerfile: ./images/nginx/Dockerfile # путь до dockerFile из которого будет собран docker-образ
    ports:
      - "80:80"
      - "443:443"
    networks:
      - network
    depends_on:
      - php-fpm
    volumes:
       - ./app/backend:/var/www/backend/
       - ./app/frontend:/var/www/frontend/
  php-fpm:
    build:
      context: .
      dockerfile: ./images/php-fpm/Dockerfile
    environment:
      XDEBUG_CONFIG: remote_host=host.docker.internal
    networks:
      - network
    extra_hosts:
      - host.docker.internal:host-gateway
    volumes:
      - ./app/backend:/var/www/backend/
      - ./images/php-fpm/config/docker-php-ext-xdebug.ini:/usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini
  frontend:
    build:
      context: .
      dockerfile: ./images/frontend/Dockerfile
    networks:
      - network
    volumes:
      - ./app/frontend:/var/www/frontend/
    ports:
      - "3000:3000"
    tty: true

  # mysql:
  #   image: "mariadb:10.3"
  #   ports:
  #     - "3306:3306"
  #   environment:
  #     MARIADB_ROOT_PASSWORD: passwd
  #     MYSQL_DATABASE: "db_name"
  #   networks:
  #     - network
  #   volumes:
  #     - ./:/var/www/app/
  # adminer:
  #   image: adminer
  #   ports:
  #     - 8080:8080
  #   networks:
  #     - network

networks:
  network:
    driver: bridge
